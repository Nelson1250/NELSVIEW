{"ast":null,"code":"var _jsxFileName = \"/Users/nelso/Desktop/pytry/frontend/src/DicomViewer.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\n\n// ThreeDViewer component for interactive 3D visualization\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ThreeDViewer = ({\n  volumeData\n}) => {\n  _s();\n  const containerRef = useRef(null);\n  const [renderer, setRenderer] = useState(null);\n  const [scene, setScene] = useState(null);\n  const [camera, setCamera] = useState(null);\n  const [controls, setControls] = useState(null);\n\n  // Initialize Three.js scene\n  useEffect(() => {\n    if (!containerRef.current || !volumeData) return;\n\n    // Setup scene\n    const newScene = new THREE.Scene();\n    newScene.background = new THREE.Color(0x000000);\n\n    // Setup camera\n    const aspectRatio = containerRef.current.clientWidth / containerRef.current.clientHeight;\n    const newCamera = new THREE.PerspectiveCamera(75, aspectRatio, 0.1, 1000);\n    newCamera.position.z = 200;\n\n    // Setup renderer\n    const newRenderer = new THREE.WebGLRenderer({\n      antialias: true\n    });\n    newRenderer.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);\n    containerRef.current.appendChild(newRenderer.domElement);\n\n    // Setup controls\n    const newControls = new OrbitControls(newCamera, newRenderer.domElement);\n    newControls.enableDamping = true;\n    newControls.dampingFactor = 0.25;\n\n    // Add lighting\n    const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);\n    newScene.add(ambientLight);\n    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);\n    directionalLight.position.set(0, 1, 1);\n    newScene.add(directionalLight);\n\n    // Store references\n    setScene(newScene);\n    setCamera(newCamera);\n    setRenderer(newRenderer);\n    setControls(newControls);\n\n    // Animation loop\n    const animate = () => {\n      requestAnimationFrame(animate);\n      if (newControls) {\n        newControls.update();\n      }\n      if (newRenderer && newScene && newCamera) {\n        newRenderer.render(newScene, newCamera);\n      }\n    };\n    animate();\n\n    // Cleanup on unmount\n    return () => {\n      if (containerRef.current && newRenderer) {\n        containerRef.current.removeChild(newRenderer.domElement);\n      }\n    };\n  }, [volumeData]);\n\n  // Update scene when volume data changes\n  useEffect(() => {\n    if (!scene || !volumeData || !volumeData.points || volumeData.points.length === 0) return;\n\n    // Clear previous points\n    scene.children = scene.children.filter(child => child instanceof THREE.AmbientLight || child instanceof THREE.DirectionalLight);\n\n    // Add points to scene\n    const geometry = new THREE.BufferGeometry();\n\n    // Prepare vertices and colors\n    const vertices = [];\n    const colors = [];\n    volumeData.points.forEach((point, index) => {\n      // Add vertex coordinates\n      vertices.push(point[0], point[1], point[2]);\n\n      // Add vertex color\n      const color = volumeData.colors[index];\n      colors.push(color[0], color[1], color[2]);\n    });\n\n    // Set geometry attributes\n    geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));\n    geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));\n\n    // Create point cloud material\n    const material = new THREE.PointsMaterial({\n      size: 2,\n      vertexColors: true,\n      transparent: true,\n      opacity: 0.8\n    });\n\n    // Create point cloud and add to scene\n    const pointCloud = new THREE.Points(geometry, material);\n    scene.add(pointCloud);\n\n    // Center the point cloud\n    const box = new THREE.Box3().setFromObject(pointCloud);\n    const center = box.getCenter(new THREE.Vector3());\n    pointCloud.position.sub(center);\n\n    // Adjust camera position\n    const maxDimension = Math.max(volumeData.dimensions[0], volumeData.dimensions[1], volumeData.dimensions[2]);\n    camera.position.z = maxDimension * 1.5;\n    if (controls) {\n      controls.update();\n    }\n  }, [scene, camera, controls, volumeData]);\n\n  // Handle window resize\n  useEffect(() => {\n    const handleResize = () => {\n      if (!containerRef.current || !camera || !renderer) return;\n      camera.aspect = containerRef.current.clientWidth / containerRef.current.clientHeight;\n      camera.updateProjectionMatrix();\n      renderer.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);\n    };\n    window.addEventListener('resize', handleResize);\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [camera, renderer]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: containerRef,\n    style: {\n      width: '100%',\n      height: '400px',\n      minHeight: '400px'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 148,\n    columnNumber: 5\n  }, this);\n};\n\n// Main DicomViewer component\n_s(ThreeDViewer, \"G7iPtEavrZiTK2YcoNdV/Z9y9W8=\");\n_c = ThreeDViewer;\nconst DicomViewer = () => {\n  _s2();\n  const [files, setFiles] = useState([]);\n  const [uploadId, setUploadId] = useState(null);\n  const [fileCount, setFileCount] = useState(0);\n  const [viewMode, setViewMode] = useState('2d');\n  const [loading, setLoading] = useState(false);\n  const [processing, setProcessing] = useState(false);\n  const [resultImage, setResultImage] = useState(null);\n  const [volumeData, setVolumeData] = useState(null);\n  const [error, setError] = useState(null);\n\n  // Base URL for API calls\n  const API_URL = 'http://localhost:5001';\n  const handleFileChange = e => {\n    if (e.target.files && e.target.files.length > 0) {\n      setFiles(Array.from(e.target.files));\n      setFileCount(e.target.files.length);\n      // Reset previous results when new files are selected\n      setUploadId(null);\n      setResultImage(null);\n      setVolumeData(null);\n      setError(null);\n    }\n  };\n  const uploadFiles = async () => {\n    if (files.length === 0) {\n      setError('Please select files to upload');\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    const formData = new FormData();\n    files.forEach(file => {\n      formData.append('files[]', file);\n    });\n    try {\n      const response = await fetch(`${API_URL}/upload`, {\n        method: 'POST',\n        body: formData\n      });\n      const data = await response.json();\n      if (!response.ok) {\n        throw new Error(data.error || 'Upload failed');\n      }\n      setUploadId(data.upload_id);\n      setFileCount(data.file_count);\n    } catch (error) {\n      console.error(\"Upload error:\", error);\n      setError(`Error uploading files: ${error.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const processFiles = async () => {\n    if (!uploadId) {\n      setError('Please upload files first');\n      return;\n    }\n    setProcessing(true);\n    setError(null);\n\n    // Reset previous results\n    setResultImage(null);\n    setVolumeData(null);\n    try {\n      // Different endpoints for 2D and 3D\n      const endpoint = viewMode === '2d' ? '/process' : '/process_3d';\n      const response = await fetch(`${API_URL}${endpoint}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          upload_id: uploadId,\n          view_type: viewMode\n        })\n      });\n      const data = await response.json();\n      if (!response.ok) {\n        throw new Error(data.error || data.details || 'Processing failed');\n      }\n      if (viewMode === '2d') {\n        // Handle 2D processing result\n        if (data.success && data.images && data.images.length > 0) {\n          setResultImage(`${API_URL}${data.images[0]}`);\n        } else {\n          throw new Error('No images were generated');\n        }\n      } else {\n        // Handle 3D processing result\n        if (data.success && data.volume_data) {\n          setVolumeData(data.volume_data);\n        } else {\n          throw new Error('No 3D data was generated');\n        }\n      }\n    } catch (error) {\n      console.error(\"Processing error:\", error);\n      setError(`Error processing files: ${error.message}`);\n    } finally {\n      setProcessing(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col h-screen bg-gray-100\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-gray-800 text-white p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-2xl font-bold\",\n        children: \"DICOM Hologram Viewer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 flex flex-col md:flex-row p-4 space-y-4 md:space-y-0 md:space-x-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full md:w-1/4 bg-white rounded-lg shadow p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold mb-4\",\n          children: \"Controls\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: \"Upload DICOM Files\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            multiple: true,\n            accept: \".dcm,.ima\",\n            onChange: handleFileChange,\n            className: \"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this), files.length > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-700 mt-1\",\n            children: [files.length, \" file(s) selected\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: uploadFiles,\n            disabled: loading || files.length === 0,\n            className: \"mt-3 w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300\",\n            children: loading ? 'Uploading...' : 'Upload Files'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 11\n        }, this), uploadId && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"View Mode\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  setViewMode('2d');\n                  setVolumeData(null);\n                  setResultImage(null);\n                },\n                className: `px-4 py-2 rounded-lg ${viewMode === '2d' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-800'}`,\n                children: \"2D Slices\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 323,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  setViewMode('3d');\n                  setVolumeData(null);\n                  setResultImage(null);\n                },\n                className: `px-4 py-2 rounded-lg ${viewMode === '3d' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-800'}`,\n                children: \"3D Hologram\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: processFiles,\n            disabled: processing,\n            className: \"w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300\",\n            children: processing ? 'Processing...' : 'Process DICOM Files'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-4 p-3 bg-blue-50 rounded-lg\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-blue-800\",\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Uploaded:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 19\n              }, this), \" \", fileCount, \" DICOM files\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 15\n          }, this), viewMode === '3d' && volumeData && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-4 p-3 bg-green-50 rounded-lg\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-green-800 font-medium\",\n              children: \"3D Controls:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 370,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"text-xs text-green-700 mt-1 list-disc list-inside\",\n              children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Left click + drag to rotate\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 372,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Right click + drag to pan\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 373,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Scroll to zoom in/out\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 374,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full md:w-3/4 bg-white rounded-lg shadow p-4 flex flex-col\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold mb-4\",\n          children: viewMode === '2d' ? 'DICOM Slice Viewer' : '3D Hologram Viewer'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 relative\",\n          children: [(loading || processing) && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-0 flex items-center justify-center bg-gray-200 bg-opacity-75 z-10\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"ml-3 font-medium text-gray-700\",\n              children: loading ? 'Uploading...' : 'Processing...'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 15\n          }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 398,\n            columnNumber: 15\n          }, this), !resultImage && !volumeData && !loading && !processing && !error && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute inset-0 flex items-center justify-center bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-500\",\n                children: \"No DICOM files processed\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 406,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-400 text-sm mt-2\",\n                children: \"Upload files and click \\\"Process DICOM Files\\\"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 407,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 405,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 15\n          }, this), viewMode === '2d' && resultImage && /*#__PURE__*/_jsxDEV(\"img\", {\n            src: resultImage,\n            alt: \"DICOM slice visualization\",\n            className: \"max-w-full max-h-full object-contain mx-auto\",\n            style: {\n              minHeight: '400px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 15\n          }, this), viewMode === '3d' && volumeData && /*#__PURE__*/_jsxDEV(ThreeDViewer, {\n            volumeData: volumeData\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 422,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-gray-800 text-white p-2 text-center text-sm\",\n      children: \"DICOM Hologram Viewer - \\xA9 2025\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 428,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 276,\n    columnNumber: 5\n  }, this);\n};\n_s2(DicomViewer, \"yvsVGSSMr1fqESBBcL0YspmX/pE=\");\n_c2 = DicomViewer;\nexport default DicomViewer;\nvar _c, _c2;\n$RefreshReg$(_c, \"ThreeDViewer\");\n$RefreshReg$(_c2, \"DicomViewer\");","map":{"version":3,"names":["React","useState","useEffect","useRef","THREE","OrbitControls","jsxDEV","_jsxDEV","Fragment","_Fragment","ThreeDViewer","volumeData","_s","containerRef","renderer","setRenderer","scene","setScene","camera","setCamera","controls","setControls","current","newScene","Scene","background","Color","aspectRatio","clientWidth","clientHeight","newCamera","PerspectiveCamera","position","z","newRenderer","WebGLRenderer","antialias","setSize","appendChild","domElement","newControls","enableDamping","dampingFactor","ambientLight","AmbientLight","add","directionalLight","DirectionalLight","set","animate","requestAnimationFrame","update","render","removeChild","points","length","children","filter","child","geometry","BufferGeometry","vertices","colors","forEach","point","index","push","color","setAttribute","Float32BufferAttribute","material","PointsMaterial","size","vertexColors","transparent","opacity","pointCloud","Points","box","Box3","setFromObject","center","getCenter","Vector3","sub","maxDimension","Math","max","dimensions","handleResize","aspect","updateProjectionMatrix","window","addEventListener","removeEventListener","ref","style","width","height","minHeight","fileName","_jsxFileName","lineNumber","columnNumber","_c","DicomViewer","_s2","files","setFiles","uploadId","setUploadId","fileCount","setFileCount","viewMode","setViewMode","loading","setLoading","processing","setProcessing","resultImage","setResultImage","setVolumeData","error","setError","API_URL","handleFileChange","e","target","Array","from","uploadFiles","formData","FormData","file","append","response","fetch","method","body","data","json","ok","Error","upload_id","file_count","console","message","processFiles","endpoint","headers","JSON","stringify","view_type","details","success","images","volume_data","className","type","multiple","accept","onChange","onClick","disabled","src","alt","_c2","$RefreshReg$"],"sources":["/Users/nelso/Desktop/pytry/frontend/src/DicomViewer.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\n\n// ThreeDViewer component for interactive 3D visualization\nconst ThreeDViewer = ({ volumeData }) => {\n  const containerRef = useRef(null);\n  const [renderer, setRenderer] = useState(null);\n  const [scene, setScene] = useState(null);\n  const [camera, setCamera] = useState(null);\n  const [controls, setControls] = useState(null);\n\n  // Initialize Three.js scene\n  useEffect(() => {\n    if (!containerRef.current || !volumeData) return;\n\n    // Setup scene\n    const newScene = new THREE.Scene();\n    newScene.background = new THREE.Color(0x000000);\n    \n    // Setup camera\n    const aspectRatio = containerRef.current.clientWidth / containerRef.current.clientHeight;\n    const newCamera = new THREE.PerspectiveCamera(75, aspectRatio, 0.1, 1000);\n    newCamera.position.z = 200;\n    \n    // Setup renderer\n    const newRenderer = new THREE.WebGLRenderer({ antialias: true });\n    newRenderer.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);\n    containerRef.current.appendChild(newRenderer.domElement);\n    \n    // Setup controls\n    const newControls = new OrbitControls(newCamera, newRenderer.domElement);\n    newControls.enableDamping = true;\n    newControls.dampingFactor = 0.25;\n    \n    // Add lighting\n    const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);\n    newScene.add(ambientLight);\n    \n    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);\n    directionalLight.position.set(0, 1, 1);\n    newScene.add(directionalLight);\n    \n    // Store references\n    setScene(newScene);\n    setCamera(newCamera);\n    setRenderer(newRenderer);\n    setControls(newControls);\n    \n    // Animation loop\n    const animate = () => {\n      requestAnimationFrame(animate);\n      \n      if (newControls) {\n        newControls.update();\n      }\n      \n      if (newRenderer && newScene && newCamera) {\n        newRenderer.render(newScene, newCamera);\n      }\n    };\n    \n    animate();\n    \n    // Cleanup on unmount\n    return () => {\n      if (containerRef.current && newRenderer) {\n        containerRef.current.removeChild(newRenderer.domElement);\n      }\n    };\n  }, [volumeData]);\n  \n  // Update scene when volume data changes\n  useEffect(() => {\n    if (!scene || !volumeData || !volumeData.points || volumeData.points.length === 0) return;\n    \n    // Clear previous points\n    scene.children = scene.children.filter(child => \n      child instanceof THREE.AmbientLight || child instanceof THREE.DirectionalLight);\n    \n    // Add points to scene\n    const geometry = new THREE.BufferGeometry();\n    \n    // Prepare vertices and colors\n    const vertices = [];\n    const colors = [];\n    \n    volumeData.points.forEach((point, index) => {\n      // Add vertex coordinates\n      vertices.push(point[0], point[1], point[2]);\n      \n      // Add vertex color\n      const color = volumeData.colors[index];\n      colors.push(color[0], color[1], color[2]);\n    });\n    \n    // Set geometry attributes\n    geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));\n    geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));\n    \n    // Create point cloud material\n    const material = new THREE.PointsMaterial({\n      size: 2,\n      vertexColors: true,\n      transparent: true,\n      opacity: 0.8\n    });\n    \n    // Create point cloud and add to scene\n    const pointCloud = new THREE.Points(geometry, material);\n    scene.add(pointCloud);\n    \n    // Center the point cloud\n    const box = new THREE.Box3().setFromObject(pointCloud);\n    const center = box.getCenter(new THREE.Vector3());\n    pointCloud.position.sub(center);\n    \n    // Adjust camera position\n    const maxDimension = Math.max(\n      volumeData.dimensions[0], \n      volumeData.dimensions[1], \n      volumeData.dimensions[2]\n    );\n    camera.position.z = maxDimension * 1.5;\n    \n    if (controls) {\n      controls.update();\n    }\n  }, [scene, camera, controls, volumeData]);\n  \n  // Handle window resize\n  useEffect(() => {\n    const handleResize = () => {\n      if (!containerRef.current || !camera || !renderer) return;\n      \n      camera.aspect = containerRef.current.clientWidth / containerRef.current.clientHeight;\n      camera.updateProjectionMatrix();\n      renderer.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [camera, renderer]);\n  \n  return (\n    <div \n      ref={containerRef} \n      style={{ width: '100%', height: '400px', minHeight: '400px' }}\n    ></div>\n  );\n};\n\n// Main DicomViewer component\nconst DicomViewer = () => {\n  const [files, setFiles] = useState([]);\n  const [uploadId, setUploadId] = useState(null);\n  const [fileCount, setFileCount] = useState(0);\n  const [viewMode, setViewMode] = useState('2d');\n  const [loading, setLoading] = useState(false);\n  const [processing, setProcessing] = useState(false);\n  const [resultImage, setResultImage] = useState(null);\n  const [volumeData, setVolumeData] = useState(null);\n  const [error, setError] = useState(null);\n  \n  // Base URL for API calls\n  const API_URL = 'http://localhost:5001';\n  \n  const handleFileChange = (e) => {\n    if (e.target.files && e.target.files.length > 0) {\n      setFiles(Array.from(e.target.files));\n      setFileCount(e.target.files.length);\n      // Reset previous results when new files are selected\n      setUploadId(null);\n      setResultImage(null);\n      setVolumeData(null);\n      setError(null);\n    }\n  };\n  \n  const uploadFiles = async () => {\n    if (files.length === 0) {\n      setError('Please select files to upload');\n      return;\n    }\n    \n    setLoading(true);\n    setError(null);\n    \n    const formData = new FormData();\n    files.forEach(file => {\n      formData.append('files[]', file);\n    });\n    \n    try {\n      const response = await fetch(`${API_URL}/upload`, {\n        method: 'POST',\n        body: formData\n      });\n      \n      const data = await response.json();\n      \n      if (!response.ok) {\n        throw new Error(data.error || 'Upload failed');\n      }\n      \n      setUploadId(data.upload_id);\n      setFileCount(data.file_count);\n    } catch (error) {\n      console.error(\"Upload error:\", error);\n      setError(`Error uploading files: ${error.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n  \n  const processFiles = async () => {\n    if (!uploadId) {\n      setError('Please upload files first');\n      return;\n    }\n    \n    setProcessing(true);\n    setError(null);\n    \n    // Reset previous results\n    setResultImage(null);\n    setVolumeData(null);\n    \n    try {\n      // Different endpoints for 2D and 3D\n      const endpoint = viewMode === '2d' ? '/process' : '/process_3d';\n      \n      const response = await fetch(`${API_URL}${endpoint}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          upload_id: uploadId,\n          view_type: viewMode\n        })\n      });\n      \n      const data = await response.json();\n      \n      if (!response.ok) {\n        throw new Error(data.error || data.details || 'Processing failed');\n      }\n      \n      if (viewMode === '2d') {\n        // Handle 2D processing result\n        if (data.success && data.images && data.images.length > 0) {\n          setResultImage(`${API_URL}${data.images[0]}`);\n        } else {\n          throw new Error('No images were generated');\n        }\n      } else {\n        // Handle 3D processing result\n        if (data.success && data.volume_data) {\n          setVolumeData(data.volume_data);\n        } else {\n          throw new Error('No 3D data was generated');\n        }\n      }\n    } catch (error) {\n      console.error(\"Processing error:\", error);\n      setError(`Error processing files: ${error.message}`);\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col h-screen bg-gray-100\">\n      <div className=\"bg-gray-800 text-white p-4\">\n        <h1 className=\"text-2xl font-bold\">DICOM Hologram Viewer</h1>\n      </div>\n      \n      <div className=\"flex-1 flex flex-col md:flex-row p-4 space-y-4 md:space-y-0 md:space-x-4\">\n        <div className=\"w-full md:w-1/4 bg-white rounded-lg shadow p-4\">\n          <h2 className=\"text-xl font-semibold mb-4\">Controls</h2>\n          \n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Upload DICOM Files\n            </label>\n            <input\n              type=\"file\"\n              multiple\n              accept=\".dcm,.ima\"\n              onChange={handleFileChange}\n              className=\"block w-full text-sm text-gray-500\n                file:mr-4 file:py-2 file:px-4\n                file:rounded-full file:border-0\n                file:text-sm file:font-semibold\n                file:bg-blue-50 file:text-blue-700\n                hover:file:bg-blue-100\"\n            />\n            {files.length > 0 && (\n              <p className=\"text-xs text-gray-700 mt-1\">\n                {files.length} file(s) selected\n              </p>\n            )}\n            \n            <button\n              onClick={uploadFiles}\n              disabled={loading || files.length === 0}\n              className=\"mt-3 w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300\"\n            >\n              {loading ? 'Uploading...' : 'Upload Files'}\n            </button>\n          </div>\n          \n          {uploadId && (\n            <>\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  View Mode\n                </label>\n                <div className=\"flex space-x-2\">\n                  <button\n                    onClick={() => {\n                      setViewMode('2d');\n                      setVolumeData(null);\n                      setResultImage(null);\n                    }}\n                    className={`px-4 py-2 rounded-lg ${\n                      viewMode === '2d'\n                        ? 'bg-blue-600 text-white'\n                        : 'bg-gray-200 text-gray-800'\n                    }`}\n                  >\n                    2D Slices\n                  </button>\n                  <button\n                    onClick={() => {\n                      setViewMode('3d');\n                      setVolumeData(null);\n                      setResultImage(null);\n                    }}\n                    className={`px-4 py-2 rounded-lg ${\n                      viewMode === '3d'\n                        ? 'bg-blue-600 text-white'\n                        : 'bg-gray-200 text-gray-800'\n                    }`}\n                  >\n                    3D Hologram\n                  </button>\n                </div>\n              </div>\n              \n              <button\n                onClick={processFiles}\n                disabled={processing}\n                className=\"w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300\"\n              >\n                {processing ? 'Processing...' : 'Process DICOM Files'}\n              </button>\n              \n              <div className=\"mt-4 p-3 bg-blue-50 rounded-lg\">\n                <p className=\"text-sm text-blue-800\">\n                  <strong>Uploaded:</strong> {fileCount} DICOM files\n                </p>\n              </div>\n              \n              {viewMode === '3d' && volumeData && (\n                <div className=\"mt-4 p-3 bg-green-50 rounded-lg\">\n                  <p className=\"text-sm text-green-800 font-medium\">3D Controls:</p>\n                  <ul className=\"text-xs text-green-700 mt-1 list-disc list-inside\">\n                    <li>Left click + drag to rotate</li>\n                    <li>Right click + drag to pan</li>\n                    <li>Scroll to zoom in/out</li>\n                  </ul>\n                </div>\n              )}\n            </>\n          )}\n        </div>\n        \n        <div className=\"w-full md:w-3/4 bg-white rounded-lg shadow p-4 flex flex-col\">\n          <h2 className=\"text-xl font-semibold mb-4\">\n            {viewMode === '2d' ? 'DICOM Slice Viewer' : '3D Hologram Viewer'}\n          </h2>\n          \n          <div className=\"flex-1 relative\">\n            {(loading || processing) && (\n              <div className=\"absolute inset-0 flex items-center justify-center bg-gray-200 bg-opacity-75 z-10\">\n                <div className=\"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500\"></div>\n                <p className=\"ml-3 font-medium text-gray-700\">\n                  {loading ? 'Uploading...' : 'Processing...'}\n                </p>\n              </div>\n            )}\n            \n            {error && (\n              <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\">\n                {error}\n              </div>\n            )}\n            \n            {!resultImage && !volumeData && !loading && !processing && !error && (\n              <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg\">\n                <div className=\"text-center\">\n                  <p className=\"text-gray-500\">No DICOM files processed</p>\n                  <p className=\"text-gray-400 text-sm mt-2\">Upload files and click \"Process DICOM Files\"</p>\n                </div>\n              </div>\n            )}\n            \n            {viewMode === '2d' && resultImage && (\n              <img \n                src={resultImage} \n                alt=\"DICOM slice visualization\" \n                className=\"max-w-full max-h-full object-contain mx-auto\"\n                style={{ minHeight: '400px' }}\n              />\n            )}\n            \n            {viewMode === '3d' && volumeData && (\n              <ThreeDViewer volumeData={volumeData} />\n            )}\n          </div>\n        </div>\n      </div>\n      \n      <div className=\"bg-gray-800 text-white p-2 text-center text-sm\">\n        DICOM Hologram Viewer - Â© 2025\n      </div>\n    </div>\n  );\n};\n\nexport default DicomViewer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}